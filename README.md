# AvengaTest

- Demo project to test [FakeRESTApi](https://fakerestapi.azurewebsites.net/index.html)
- FakeRESRApi is REST API of a bookstore
  - Implemented API tests of Integration level
  - I like BDD and higher level tests, but since this project does not create any actual
    data there's no possibility to create any real flows, use roles, etc
- Components:
  - Java, Maven, TestNG, RestAssured
  - Reporting by `extentreports`
  - Random data generated by `datafaker`
  - Logs via `slf4j-simple`
  - `.env` via `dotenv-java`

## Scenarios

- [AuthorsTests.java](src/test/java/info/dvad/avengatest/tests/AuthorsTest.java) covers Authors API
- [BooksTests.java](src/test/java/info/dvad/avengatest/tests/AuthorsTest.java) covers Books API

## WARNING
Test `AuthorsTest.shouldBeAbleToAddAuthor()` is my only attempt to implement a happy path. And it fails because projects' 
behavior differs from a real one. It's in your hands to see it green, please refer its Javadoc. 

## Environment variables

- Project needs one environment variable `BASE_URL` which points to v1 of the API and its default value is 
`https://fakerestapi.azurewebsites.net/api/v1`
- You can create `.env` file in the project root and place its initialization there:

```
BASE_URL=https://fakerestapi.azurewebsites.net/api/v1
```

## How to execute

```
git clone git@github.com:lokiOdUa/AvengaTest.git
cd AvengaTest
mvn test
```

## Docker

Project contains a [Dockerfile](Dockerfile) which executes all the tests being started. To run, use the following command:

```
docker run --rm \
  -e BASE_URL="https://fakerestapi.azurewebsites.net/api/v1" \
  -v "$(pwd)/reports:/app/reports" \
  avengatest
```

## CI/CD Integration

There's a [Jenkinsfile](Jenkinsfile) which consists of 3 phases:

- Building Docker image
- Executing API tests
- Creating and publishing HTML report

Environment variable `BASE_URL` is passed as a parameter from the job form.

## AQA-related Features implemented

### Data Providers

In TestNG, a Data Provider is a powerful feature that allows us to run the same test method multiple times with different 
sets of data. It's called data-driven testing. This makes tests more efficient, reusable, and easier to maintain. Please 
take a look at [DataProviders.java](src/test/java/info/dvad/avengatest/utils/DataProviders.java) for implementation details. 
For example, the same `invalidAuthors` data provider is being used as data source in the following tests:
- `AuthorsTest.shouldFailInExpectedWayIfAddingIncorrectAuthor()`
- `AuthorsTest.shouldFailInExpectedWayIfIncorrectlyUpdatingAuthor()`

### Hamcrest Matchers

RestAssured is a powerful thing which uses matchers from a separate framework - Hamcrest. Power comes from how RestAssured
integrates Hamcrest directly into its validation syntax. In [Matchers.java](info/dvad/avengatest/utils/Matchers.java)
there's an example of implementing a custom `isCloseToNow()` matcher to ensure how far is the bookâ€™s release date from today.

### SoftAssertions

Assertions are awesome, but failed one stops execution immediately which is not always desired. Imagine checking a form
with many fields - there might be no reason to implement one scenario for each field, would be great to assert multiple 
claims at once instead. Soft assertions gives us this possibility, please see `AuthorsTest.ensureAuthorWasAddedSuccessfully()` 
method for implementation example.

# Author
- makhinya@gmail.com
- https://www.linkedin.com/in/seva-makhinia/
- https://github.com/lokiOdUa/AvengaTest
